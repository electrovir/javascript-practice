FROM prismagraphql/prisma:1.21
ARG PRISMA_MANAGEMENT_API_SECRET
ARG PRISMA_DATABASE_HOST
ARG PRISMA_DATABASE_NAME
ARG PRISMA_DATABASE_USERNAME
ARG PRISMA_DATABASE_PASSWORD
ENV PRISMA_CONFIG_PATH prisma.yml
COPY backend/config.yml prisma.yml
RUN sed -i s/PRISMA_MANAGEMENT_API_SECRET/$PRISMA_MANAGEMENT_API_SECRET/g prisma.yml
RUN sed -i s/PRISMA_DATABASE_HOST/$PRISMA_DATABASE_HOST/g prisma.yml
RUN sed -i s/PRISMA_DATABASE_NAME/$PRISMA_DATABASE_NAME/g prisma.yml
RUN sed -i s/PRISMA_DATABASE_USERNAME/$PRISMA_DATABASE_USERNAME/g prisma.yml
RUN sed -i s/PRISMA_DATABASE_PASSWORD/$PRISMA_DATABASE_PASSWORD/g prisma.yml
EXPOSE 4466